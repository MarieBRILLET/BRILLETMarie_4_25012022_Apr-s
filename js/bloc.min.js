/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/@bloc-js/bloc@3.1.5/lib/bloc.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
"use strict";var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}(),__createBinding=this&&this.__createBinding||(Object.create?function(t,e,r,n){void 0===n&&(n=r),Object.defineProperty(t,n,{enumerable:!0,get:function(){return e[r]}})}:function(t,e,r,n){void 0===n&&(n=r),t[n]=e[r]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),__importStar=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&__createBinding(e,t,r);return __setModuleDefault(e,t),e},__importDefault=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Bloc=void 0;var rxjs_1=require("rxjs"),RxOp=__importStar(require("rxjs/operators")),fast_deep_equal_1=__importDefault(require("fast-deep-equal")),observableFromAction=function(t){return function(e){var r=e.action,n=e.resolve;return new rxjs_1.Observable((function(e){Promise.resolve(r(t,(function(t){return e.next({next:t,resolve:n})}))).catch((function(t){return e.error(t)})).finally((function(){e.complete()}))}))}},Bloc=function(t){function e(e,r){void 0===r&&(r=function(t,e){return(0,fast_deep_equal_1.default)(t,e)});var n=t.call(this)||this;return n._actions$=new rxjs_1.Subject,n._cleanupHandlers=[],n.next=function(t){return new Promise((function(e){return n._actions$.next({action:t,resolve:e})}))},n._state$=new rxjs_1.BehaviorSubject(e),n.source=n.transformState(n._state$),n.transformActions(n._actions$).pipe(RxOp.concatMap(observableFromAction(n))).subscribe((function(t){var e=t.next,o=t.resolve;if(r(n.value,e))return o();n._state$.next(e),o()}),(function(t){return n._state$.error(t)})),n}return __extends(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._state$.value},enumerable:!1,configurable:!0}),e.prototype.transformActions=function(t){return t},e.prototype.transformState=function(t){return t},e.prototype.unsubscribeOnComplete=function(t,e){this._cleanupHandlers.push((function(){t.unsubscribe(),e&&e()}))},e.prototype.complete=function(){this._cleanupHandlers.forEach((function(t){return t()})),this._actions$.complete()},e}(rxjs_1.Observable);exports.Bloc=Bloc;
//# sourceMappingURL=/sm/bcb01212b5832c7546f6ca90660071ce9ef88baf3c63c5ae5a55475cfa8d33b3.map